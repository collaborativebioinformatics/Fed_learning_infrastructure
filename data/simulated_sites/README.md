# Federated Genomic Data Simulation

## Overview

Simulated genomic datasets for 10 federated learning sites representing distributed healthcare institutions. Generated using LDAK for realistic linkage disequilibrium structure and effect size distributions.

## Dataset Specifications

### Site Configuration
- **10 heterogeneous sites** with varying sample sizes and SNP counts
- Sample sizes: 88,000 - 110,000 individuals per site
- SNP counts: ~450,000 - 520,000 variants per site

### Phenotype: Parkinson's Disease
- **Binary trait** (case-control)
- **Prevalence**: 1% (realistic for elderly populations)
- **Heritability (h²)**: 0.25 (SNP heritability on liability scale)
- **Causal variants**: 20 per site
- **Effect size model**: LDAK-Thin (power = -0.25, realistic for human genetics)

### Covariates
- Auto-generated by LDAK (age, sex, and other demographic variables)
- Covariates explain ~10% of phenotypic variance

## File Structure
```
data/simulated_sites/
├── generate_federated_sites.sh    # Generation script
├── README.md                        # This file
├── ldak6.1.mac                      # LDAK binary (not in git)
└── site1/ through site10/           # Generated data (not in git)
    ├── site{N}_geno.bed/bim/fam    # Genotype data (PLINK format)
    ├── site{N}_pheno.pheno          # Phenotype data
    ├── site{N}_geno.covar           # Covariate data
    └── site{N}_pheno.effects        # True causal effect sizes
```

## Generating the Data

### Prerequisites
1. **LDAK 6.1+**: Download from https://dougspeed.com
```bash
   curl -L -o ldak6.1.mac https://github.com/dougspeed/LDAK/raw/main/ldak6.1.mac
   chmod +x ldak6.1.mac
```

2. **System requirements**:
   - ~3 GB disk space
   - 2-5 hours runtime
   - 8+ GB RAM recommended

### Running the Simulation
```bash
cd data/simulated_sites

# Make script executable
chmod +x generate_federated_sites.sh

# Run simulation
./generate_federated_sites.sh

# Or run in background with logging
nohup ./generate_federated_sites.sh > generation.log 2>&1 &
tail -f generation.log
```

## Data Format

### Genotypes (.bed/.bim/.fam)
- **Format**: PLINK binary format
- **Encoding**: 0/1/2 (additive model, count of minor allele)
- View with: `plink2 --bfile site1/site1_geno --freq`

### Phenotypes (.pheno)
```
FID IID Pheno
1   1   0      # Control
2   2   1      # Case
```

### Covariates (.covar)
```
FID IID Age Sex [additional covariates...]
1   1   65  0
2   2   72  1
```

## Use Cases

1. **Federated GWAS**: Test federated learning algorithms for genome-wide association studies
2. **Privacy-preserving genomics**: Benchmark secure multi-party computation methods
3. **Meta-analysis validation**: Compare federated vs. centralized analysis approaches
4. **Heterogeneity testing**: Evaluate robustness to varying sample sizes and SNP densities

## Citation

If using this simulated data, please cite:
- **LDAK**: Speed et al. (2020). Nature Genetics. https://doi.org/10.1038/s41588-019-0530-8
- This hackathon project: [Add DOI/repo link when available]

## Notes

- Data files are **not committed to git** due to size (~2-3 GB total)
- Each team member should regenerate locally using the script
- True causal variants and effect sizes are saved in `.effects` files for validation
- Random seed not fixed - each generation produces different (but statistically similar) data